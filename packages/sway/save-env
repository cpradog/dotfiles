#!/bin/zsh
ENVFILE="/run/user/${UID}/env"

echo "# autogenerated environment for $(whoami) at $(LC_ALL=C date)" > ${ENVFILE}
while read -r line; do
  name=$(echo $line | awk 'BEGIN {FS="="} {print $1}')
  namelen=$(expr length $name)
  value=${line:$(( namelen + 1 ))}
  echo "export $name='${value//'/''}'" >> ${ENVFILE}
done <<(env)

